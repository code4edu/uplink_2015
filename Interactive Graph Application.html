<html>
    <head>
       
        <script type="text/javascript" src="jCanvaScript.js"> </script>
		<script type="text/javascript" src="graph.js"> </script>
      
        <script>
		
        function simpleExample(){
			var FirstClickCircle = false
			var R = 20 
			var graph = []
			var keys = []
			var labels = []
			var blue = '#0000FF'
			var black = 'rgb(0,0,0)'
			var labelcolor = '#FFFF00'
			var counter = 0
			var tempcircle1
			var templabel
			function addCircle(x, y){
				var tempcircle = jc.circle(x, y, R, black, 1).id(counter)
				keys.push(tempcircle)
				var labeltemp = jc.text(counter,tempcircle.position().x - 6,tempcircle.position().y + 6).font('20px Times New Roman').color(labelcolor)
				labels.push(labeltemp)
				graph[tempcircle.id()] = []
				counter++
				update()
			}
            function addLine(circle1, circle2){
				var linetemp = jc.line([[circle1.position().x, circle1.position().y], [circle2.position().x,circle2.position().y]])
				graph[circle1.id()].push(linetemp)
				graph[circle2.id()].push(linetemp)
				update()
			}
			function update(){
				for(var i = 0; i < keys.length; i++){
					keys[i].color(black)
					}
				for(var j = 0; j < labels.length; j++){
					labels[j].up('top')
				}
			}
			
			document.onclick = function(event){
				
				if(!FirstClickCircle){
					for(var i = 0; i < keys.length; i++){
						if(keys[i].isPointIn(event.pageX,event.pageY, true)){
							keys[i].color(blue).up('top')
							templabel = labels[i]
							tempcircle1 = keys[i]
							FirstClickCircle = true
							return
						}
					}
					addCircle(event.pageX, event.pageY)
					FirstClickCircle = false
				}
				else{
					
					FirstClickCircle = false
					for(var j = 0; j < keys.length; j++){
						
						if(keys[j].isPointIn(event.pageX,event.pageY, true)){
						//alert(keys[j] != tempcircle1)
							if(keys[j] != tempcircle1){
								//alert("asdasd")
								addLine(tempcircle1, keys[j])
								tempcircle1 = null
								return
							}
						}
					}
						
							if(tempcircle1 == null)
								return
							for(var d = 0; d < keys.length; d++){
								if(tempcircle1 == keys[d]){
								for(var k = 0;k < graph[tempcircle1.id()].length; k++){
									var temp = graph[tempcircle1.id()][k].points()
									if(keys[d].isPointIn(temp[0][0], temp[0][1], true))
									{
										
										temp[0][0] = event.pageX
										temp[0][1] = event.pageY
									}
									else{
										
											temp[1][0] = event.pageX
											temp[1][1] = event.pageY
								}
											
											
									
									graph[tempcircle1.id()][k].points(temp)
									
								}
								
								keys[d].animate({x:event.pageX,y:event.pageY})
							
								labels[d].animate({x:event.pageX - 6,y:event.pageY + 6})
								
								
								}
							}	
							
							tempcircle1 = null
							update()
							return
						
					}
				}
				
				jc.start('canvas_1', true);
			}
        </script>
    <head>
    <body onload="simpleExample()">
        <canvas height="500" width="500" id="canvas_1" style="border:2px solid #000000;"></canvas>
    </body>
    </html>