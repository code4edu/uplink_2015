<html>
    <head>
       
        <script type="text/javascript" src="jCanvaScript.js"> </script>
		<script type="text/javascript" src="graph.js"> </script>
      
        <script>
		
        function simpleExample(){
			var FirstClickCircle = false
			var R = 20 
			var graph = []
			var keys = []
			var labels = []
			var blue = '#0000FF'
			var black = 'rgb(0,0,0)'
			var labelcolor = '#FFFF00'
			var counter = 0
			var tempcircle1
			var templabel
			function addCircle(x, y){
				var tempcircle = jc.circle(x, y, R, black, 1).id(counter)
				keys.push(tempcircle)
				var labeltemp = jc.text(counter,tempcircle.position().x - 6,tempcircle.position().y + 6).font('20px Times New Roman').color(labelcolor)
				labels.push(labeltemp)
				graph[tempcircle.id()] = []
				counter++
				update()
			}
            function addLine(circle1, circle2){
				var linetemp = jc.line([[circle1.position().x, circle1.position().y], [circle2.position().x,circle2.position().y]])
				graph[circle1.id()].push(linetemp)
				graph[circle2.id()].push(linetemp)
				update()
			}
			function update(){
				for(var i = 0; i < keys.length; i++){
					keys[i].color(black)
					}
				for(var j = 0; j < labels.length; j++){
					labels[j].up('top')
				}
			}
			
			document.onclick = function(event){
				if(event.pageX >= 500 || event.pageY >= 500)
					return
				if(!FirstClickCircle){
					for(var i = 0; i < keys.length; i++){
						if(keys[i].isPointIn(event.pageX + 10,event.pageY + 10, true) || keys[i].isPointIn(event.pageX - 10,event.pageY + 10, true) || keys[i].isPointIn(event.pageX + 10,event.pageY - 10, true) || keys[i].isPointIn(event.pageX - 10,event.pageY - 10, true)){
							keys[i].color(blue).up('top')
							templabel = labels[i]
							tempcircle1 = keys[i]
							FirstClickCircle = true
							return
						}
					}
					addCircle(event.pageX, event.pageY)
					FirstClickCircle = false
				}
				else{
					
					FirstClickCircle = false
					for(var j = 0; j < keys.length; j++){
						if(keys[j].isPointIn(event.pageX,event.pageY, true)){
						//alert(keys[j] != tempcircle1)
							if(keys[j] != tempcircle1){
								//alert("asdasd")
								addLine(tempcircle1, keys[j])
								tempcircle1 = null
								return
							}
						}
					}
						
							if(tempcircle1 == null)
								return
							for(var d = 0; d < keys.length; d++){
								if(tempcircle1 == keys[d]){
								for(var k = 0;k < graph[tempcircle1.id()].length; k++){
									var temp = graph[tempcircle1.id()][k].points()
									if(keys[d].isPointIn(temp[0][0], temp[0][1], true))
									{
										
										temp[0][0] = event.pageX
										temp[0][1] = event.pageY
									}
									else{
										
											temp[1][0] = event.pageX
											temp[1][1] = event.pageY
								}
											
											
									
									graph[tempcircle1.id()][k].points(temp)
									
								}
								
								keys[d].animate({x:event.pageX,y:event.pageY})
							
								labels[d].animate({x:event.pageX - 6,y:event.pageY + 6})
								
								
								}
							}	
							
							tempcircle1 = null
							update()
							return
						
					}
				}
				document.getElementById('123').onclick = function(){
				
					if(tempcircle1 != null){
								for(var k = 0;k < graph[tempcircle1.id()].length; k++){
									var temp = graph[tempcircle1.id()][k].points()
									var templine =graph[tempcircle1.id()][k]
									if(tempcircle1.isPointIn(temp[0][0], temp[0][1], true) || tempcircle1.isPointIn(temp[1][0], temp[1][1], true))
									{
										graph[tempcircle1.id()][k].del()
										graph[tempcircle1.id()].splice(k, 1)
										for(var d = 0; d < keys.length; d++){
											if(keys[d].isPointIn(temp[0][0], temp[0][1], true) || keys[d].isPointIn(temp[1][0], temp[1][1], true)){
												for(var s = 0; s < graph[keys[d].id()].length;s++){
													if(graph[keys[d].id()][s]== templine){
														graph[tempcircle1.id()][s].del()
														graph[tempcircle1.id()].splice(s, 1)
													}
												}
											}
										}
									}
									
											
											
									
									
									
								}
								keys[tempcircle1.id()].del()
								
								graph.splice(tempcircle1.id(),1)
								keys.splice(tempcircle1.id(), 1)
								labels[tempcircle1.id()].del()
								tempcircle1 = null
								
								jc.start('canvas_1', true);
							
						}
						else{
							alert("Verticie was not selected")
						}
				}
				jc.start('canvas_1', true);
			}
        </script>
    </head>
    <body onload="simpleExample()">
        <canvas height="500" width="500" id="canvas_1" style="border:2px solid #000000;"></canvas>
		<button id = "123"  style="position: absolute; left: 530;"> Delete a vertex</button>
		<button  style="position: absolute; left: 530; top: 40; width: 105; height: 21" > BFS</button>
    </body>
    </html>